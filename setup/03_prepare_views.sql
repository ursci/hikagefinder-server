CREATE OR REPLACE VIEW public.roads AS 
    SELECT "gid" AS id, "geom", "source", "target" FROM public.import;

ALTER VIEW public.roads OWNER TO ursci;

CREATE MATERIALIZED VIEW IF NOT EXISTS public.shades AS 
    SELECT i.gid AS id, t.*
        FROM public.import i
            CROSS JOIN lateral (
                VALUES 
                    (i.h_8_m_0,   '08:00:00'::time),
                    (i.h_8_m_5,   '08:05:00'::time),
                    (i.h_8_m_10,  '08:10:00'::time),
                    (i.h_8_m_15,  '08:15:00'::time),
                    (i.h_8_m_20,  '08:20:00'::time),
                    (i.h_8_m_25,  '08:25:00'::time),
                    (i.h_8_m_30,  '08:30:00'::time),
                    (i.h_8_m_35,  '08:35:00'::time),
                    (i.h_8_m_40,  '08:40:00'::time),
                    (i.h_8_m_45,  '08:45:00'::time),
                    (i.h_8_m_50,  '08:50:00'::time),
                    (i.h_8_m_55,  '08:55:00'::time),
                    (i.h_9_m_0,   '09:00:00'::time),
                    (i.h_9_m_5,   '09:05:00'::time),
                    (i.h_9_m_10,  '09:10:00'::time),
                    (i.h_9_m_15,  '09:15:00'::time),
                    (i.h_9_m_20,  '09:20:00'::time),
                    (i.h_9_m_25,  '09:25:00'::time),
                    (i.h_9_m_30,  '09:30:00'::time),
                    (i.h_9_m_35,  '09:35:00'::time),
                    (i.h_9_m_40,  '09:40:00'::time),
                    (i.h_9_m_45,  '09:45:00'::time),
                    (i.h_9_m_50,  '09:50:00'::time),
                    (i.h_9_m_55,  '09:55:00'::time),
                    (i.h_10_m_0,  '10:00:00'::time),
                    (i.h_10_m_5,  '10:05:00'::time),
                    (i.h_10_m_10, '10:10:00'::time),
                    (i.h_10_m_15, '10:15:00'::time),
                    (i.h_10_m_20, '10:20:00'::time),
                    (i.h_10_m_25, '10:25:00'::time),
                    (i.h_10_m_30, '10:30:00'::time),
                    (i.h_10_m_35, '10:35:00'::time),
                    (i.h_10_m_40, '10:40:00'::time),
                    (i.h_10_m_45, '10:45:00'::time),
                    (i.h_10_m_50, '10:50:00'::time),
                    (i.h_10_m_55, '10:55:00'::time),
                    (i.h_11_m_0,  '11:00:00'::time),
                    (i.h_11_m_5,  '11:05:00'::time),
                    (i.h_11_m_10, '11:10:00'::time),
                    (i.h_11_m_15, '11:15:00'::time),
                    (i.h_11_m_20, '11:20:00'::time),
                    (i.h_11_m_25, '11:25:00'::time),
                    (i.h_11_m_30, '11:30:00'::time),
                    (i.h_11_m_35, '11:35:00'::time),
                    (i.h_11_m_40, '11:40:00'::time),
                    (i.h_11_m_45, '11:45:00'::time),
                    (i.h_11_m_50, '11:50:00'::time),
                    (i.h_11_m_55, '11:55:00'::time),
                    (i.h_12_m_0,  '12:00:00'::time),
                    (i.h_12_m_5,  '12:05:00'::time),
                    (i.h_12_m_10, '12:10:00'::time),
                    (i.h_12_m_15, '12:15:00'::time),
                    (i.h_12_m_20, '12:20:00'::time),
                    (i.h_12_m_25, '12:25:00'::time),
                    (i.h_12_m_30, '12:30:00'::time),
                    (i.h_12_m_35, '12:35:00'::time),
                    (i.h_12_m_40, '12:40:00'::time),
                    (i.h_12_m_45, '12:45:00'::time),
                    (i.h_12_m_50, '12:50:00'::time),
                    (i.h_12_m_55, '12:55:00'::time),
                    (i.h_13_m_0,  '13:00:00'::time),
                    (i.h_13_m_5,  '13:05:00'::time),
                    (i.h_13_m_10, '13:10:00'::time),
                    (i.h_13_m_15, '13:15:00'::time),
                    (i.h_13_m_20, '13:20:00'::time),
                    (i.h_13_m_25, '13:25:00'::time),
                    (i.h_13_m_30, '13:30:00'::time),
                    (i.h_13_m_35, '13:35:00'::time),
                    (i.h_13_m_40, '13:40:00'::time),
                    (i.h_13_m_45, '13:45:00'::time),
                    (i.h_13_m_50, '13:50:00'::time),
                    (i.h_13_m_55, '13:55:00'::time),
                    (i.h_14_m_0,  '14:00:00'::time),
                    (i.h_14_m_5,  '14:05:00'::time),
                    (i.h_14_m_10, '14:10:00'::time),
                    (i.h_14_m_15, '14:15:00'::time),
                    (i.h_14_m_20, '14:20:00'::time),
                    (i.h_14_m_25, '14:25:00'::time),
                    (i.h_14_m_30, '14:30:00'::time),
                    (i.h_14_m_35, '14:35:00'::time),
                    (i.h_14_m_40, '14:40:00'::time),
                    (i.h_14_m_45, '14:45:00'::time),
                    (i.h_14_m_50, '14:50:00'::time),
                    (i.h_14_m_55, '14:55:00'::time),
                    (i.h_15_m_0,  '15:00:00'::time),
                    (i.h_15_m_5,  '15:05:00'::time),
                    (i.h_15_m_10, '15:10:00'::time),
                    (i.h_15_m_15, '15:15:00'::time),
                    (i.h_15_m_20, '15:20:00'::time),
                    (i.h_15_m_25, '15:25:00'::time),
                    (i.h_15_m_30, '15:30:00'::time),
                    (i.h_15_m_35, '15:35:00'::time),
                    (i.h_15_m_40, '15:40:00'::time),
                    (i.h_15_m_45, '15:45:00'::time),
                    (i.h_15_m_50, '15:50:00'::time),
                    (i.h_15_m_55, '15:55:00'::time),
                    (i.h_16_m_0,  '16:00:00'::time),
                    (i.h_16_m_5,  '16:05:00'::time),
                    (i.h_16_m_10, '16:10:00'::time),
                    (i.h_16_m_15, '16:15:00'::time),
                    (i.h_16_m_20, '16:20:00'::time),
                    (i.h_16_m_25, '16:25:00'::time),
                    (i.h_16_m_30, '16:30:00'::time),
                    (i.h_16_m_35, '16:35:00'::time),
                    (i.h_16_m_40, '16:40:00'::time),
                    (i.h_16_m_45, '16:45:00'::time),
                    (i.h_16_m_50, '16:50:00'::time),
                    (i.h_16_m_55, '16:55:00'::time),
                    (i.h_17_m_0,  '17:00:00'::time),
                    (i.h_17_m_5,  '17:05:00'::time),
                    (i.h_17_m_10, '17:10:00'::time),
                    (i.h_17_m_15, '17:15:00'::time),
                    (i.h_17_m_20, '17:20:00'::time),
                    (i.h_17_m_25, '17:25:00'::time),
                    (i.h_17_m_30, '17:30:00'::time),
                    (i.h_17_m_35, '17:35:00'::time),
                    (i.h_17_m_40, '17:40:00'::time),
                    (i.h_17_m_45, '17:45:00'::time),
                    (i.h_17_m_50, '17:50:00'::time),
                    (i.h_17_m_55, '17:55:00'::time)       
            ) AS t(rate, "time")
        ORDER BY gid, "time";

ALTER MATERIALIZED VIEW public.shades OWNER TO ursci;

REFRESH MATERIALIZED VIEW public.shades;

CREATE INDEX IF NOT EXISTS "shades_time_idx" ON public.shades USING btree(time);
